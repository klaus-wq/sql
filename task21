Задание сделала неверно. Дополнительные задания даются сложно.

CTE - это временный результат запроса, которого можно временно сохранять в памяти и обращаться повторно.
NULLIF — это встроенная функция в SQL, которая возвращает NULL, если два переданных выражения равны, и возвращает первое выражение,
если они не равны. 
COALESCE - это встроенная функция в SQL, которая возвращает первое не NULL значение из списка переданных аргументов.